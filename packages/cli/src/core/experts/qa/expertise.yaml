# QA Expert - Domain Knowledge
# This file is the agent's "mental model" of the QA domain
# AUTO-UPDATED by self-improve.md after completing work

domain: qa
last_updated: 2025-12-21
version: 1.1

files:
  test_strategy:
    - path: docs/07-testing/
      purpose: "Test documentation and test cases"
      conventions: "Organized by test type"
    - path: docs/07-testing/test-cases/
      purpose: "Test case definitions per story"
      conventions: "One file per story US-####"
    - path: docs/07-testing/test-plan.md
      purpose: "Overall test strategy document"

  quality_metrics:
    - path: docs/07-testing/metrics/
      purpose: "Quality metrics and KPIs"
    - path: docs/07-testing/coverage/
      purpose: "Test coverage reports"

  release:
    - path: docs/07-testing/release-criteria.md
      purpose: "Release readiness checklist"
    - path: docs/07-testing/regression-suite.md
      purpose: "Regression test suite definition"

  coordination:
    - path: docs/09-agents/status.json
      purpose: "Story status including test_status"
    - path: docs/09-agents/bus/log.jsonl
      purpose: "Agent coordination messages"

relationships:
  - parent: stories
    child: test_cases
    type: mapped_to
    notes: "Each story has corresponding test cases"
  - parent: release_criteria
    child: regression_suite
    type: requires
    notes: "Release requires regression suite passing"
  - parent: test_plan
    child: test_types
    type: defines
    notes: "Test plan defines testing approach"

patterns:
  - name: Test Pyramid
    description: "Many unit tests, fewer integration, fewer E2E"
    location: docs/07-testing/test-plan.md
    example: "70% unit, 20% integration, 10% E2E"

  - name: Risk-Based Testing
    description: "More testing for high-risk areas"
    location: docs/07-testing/
    example: "Payment flows get more test coverage"

  - name: Regression Suite
    description: "Core functionality tests run before each release"
    location: docs/07-testing/regression-suite.md
    example: "Login, checkout, core workflows"

  - name: Bug Severity
    description: "Critical, High, Medium, Low severity levels"
    location: docs/07-testing/
    example: "Critical = service down, High = major feature broken"

conventions:
  - "Test early and often, not just at end"
  - "Every story needs test cases before implementation"
  - "Regression testing before every release"
  - "UAT sign-off required before production"
  - "Bug severity determines fix priority"
  - "Quality gates must pass before release"
  - "Document known issues and workarounds"

quality_gates:
  - "All automated tests passing"
  - "Code coverage meets threshold (80%+)"
  - "No critical or high severity bugs open"
  - "UAT sign-off received"
  - "Regression suite green"
  - "Performance benchmarks met"

# Learnings are AUTO-UPDATED by self-improve.md
learnings:
  - date: 2025-12-21
    context: "AgileFlow expertise validation system"
    learning: "validate-expertise.sh performs comprehensive checks on expertise.yaml files: file existence, YAML validity, required fields (domain, last_updated, version, learnings), and staleness detection (warns if last_updated >30 days old). Critical for maintaining expert knowledge quality."
    applied_to: "All expert domains"

  - date: 2025-12-21
    context: "Story testing workflow"
    learning: "test_status field in status.json tracks testing state: 'passing', 'failing', or 'not_run'. QA expert should verify test_status before approving stories. /agileflow:verify command must run successfully before marking story as 'in-review'."
    applied_to: "Story validation and review gates"

  - date: 2025-12-21
    context: "Expertise health monitoring"
    learning: "expertise-metrics.sh provides dashboard view of all expert domains: shows last_updated dates, versions, learning counts, and staleness warnings. Use this to identify experts needing knowledge updates. Run periodically to maintain expertise freshness."
    applied_to: "Expert knowledge maintenance"

  - date: 2025-12-21
    context: "Session-based test verification"
    learning: "/agileflow:baseline command establishes test baseline at session start, while /agileflow:verify runs tests and compares against baseline. This session harness pattern ensures tests pass before story approval. QA expert should encourage use of baseline/verify workflow."
    applied_to: "Test verification and story completion gates"
