# ADR Writer Expert - Domain Knowledge
# This file is the agent's "mental model" of the ADR domain
# AUTO-UPDATED by self-improve.md after completing work

domain: adr-writer
last_updated: 2025-12-21
version: 1.1

# AgileFlow-specific ADR patterns (learned from actual codebase)
files:
  decisions:
    - path: docs/03-decisions/
      purpose: "Architecture Decision Records"
      conventions: "adr-NNNN-slug.md naming (e.g., adr-0001-agent-expert-system.md)"
      example: "adr-0001-agent-expert-system.md"
    - path: docs/03-decisions/README.md
      purpose: "ADR index listing all decisions"

  research:
    - path: docs/10-research/
      purpose: "Research supporting ADR alternatives"
      naming: "YYYYMMDD-slug.md format"
    - path: docs/10-research/README.md
      purpose: "Research index"

  context:
    - path: CLAUDE.md
      purpose: "Project context informing decisions (internal)"
    - path: docs/04-architecture/
      purpose: "Architecture documentation"
    - path: docs/05-epics/
      purpose: "Epics link to ADRs for context"

relationships:
  - parent: research
    child: adrs
    type: informs
    notes: "Research provides alternatives for ADRs (see ADR-0001 referencing research)"
  - parent: adrs
    child: epics
    type: linked_from
    notes: "Epics reference ADRs (EP-0001 â†’ ADR-0001)"
  - parent: adrs
    child: implementation
    type: constrains
    notes: "ADRs constrain implementation choices"
  - parent: adrs
    child: superseding_adrs
    type: superseded_by
    notes: "Old ADRs can be superseded by new ones"

patterns:
  - name: ADR Structure (AgileFlow)
    description: "Status, Date, Decision Makers, Epic link, then sections"
    location: docs/03-decisions/adr-0001-agent-expert-system.md
    sections:
      - "Context (problem statement with research foundation)"
      - "Decision (what we're doing)"
      - "Options Considered (3-4 alternatives with rationale)"
      - "Consequences (Benefits and Trade-offs)"
      - "Implementation Plan (phased approach)"
      - "Risks and Mitigations (table format)"
      - "Success Criteria (qualitative and quantitative)"
      - "Related Documents (links to epic, research)"

  - name: ADR Header Format
    description: "Markdown frontmatter style at top"
    location: docs/03-decisions/
    example: |
      # ADR-0001: Agent Expert System
      **Status**: Accepted
      **Date**: 2025-12-16
      **Decision Makers**: Development Team
      **Epic**: [EP-0001](../05-epics/EP-0001-agent-expert-pilot.md)

  - name: Options Considered Format
    description: "Each option with brief rationale"
    location: docs/03-decisions/
    example: |
      ### Option 1: Single Global Expert (Rejected)
      - Description
      - **Rejected**: Reason why not selected

  - name: Risks Table Format
    description: "Risk and Mitigation columns"
    location: docs/03-decisions/
    example: "| Stale expertise | Mandatory validation step |"

  - name: Research-First ADR
    description: "Always reference research that informed decision"
    location: docs/10-research/
    example: "See: docs/10-research/20251216-agent-experts-self-improving-agents.md"

conventions:
  - "Research alternatives before writing ADR"
  - "Link ADR to epic that drove the decision"
  - "Document 3-4 alternatives with rationale for rejection/deferral"
  - "Include Implementation Plan with phases"
  - "Add Risks and Mitigations table"
  - "Define Success Criteria (qualitative + quantitative)"
  - "Link to Related Documents (epic, research, other ADRs)"
  - "Use lowercase-hyphenated naming: adr-0001-slug.md"

adr_statuses:
  proposed: "Under review, not yet approved"
  accepted: "Approved, should be followed"
  deprecated: "No longer recommended"
  superseded: "Replaced by newer ADR"

decision_categories:
  - "Technology choices (framework, database, language)"
  - "Architecture patterns (Agent Expert system)"
  - "Data modeling (schema design, caching)"
  - "Security approaches (auth, encryption)"
  - "Infrastructure (hosting, CI/CD)"
  - "Development practices (testing, branching)"

# Learned from AgileFlow codebase exploration
learnings:
  - date: 2025-12-21
    context: "Analyzed ADR-0001 structure"
    insight: "ADRs have rich structure: Status/Date/Epic header, Context with research, Decision, Options Considered, Consequences, Implementation Plan, Risks table, Success Criteria, Related Docs"
    source: "docs/03-decisions/adr-0001-agent-expert-system.md"

  - date: 2025-12-21
    context: "Analyzed ADR-Epic relationship"
    insight: "ADRs link to epics that drove the decision; epics link back to ADRs for context"
    source: "docs/03-decisions/adr-0001-agent-expert-system.md, docs/05-epics/ep-0001-agent-expert-pilot.md"

  - date: 2025-12-21
    context: "Analyzed Options Considered format"
    insight: "Options include: Selected, Rejected (with reason), Deferred (for future consideration)"
    source: "docs/03-decisions/adr-0001-agent-expert-system.md"

  - date: 2025-12-21
    context: "Analyzed Implementation Plan"
    insight: "ADRs include phased implementation: Phase 1 (Pilot), Phase 2 (Full Rollout), Phase 3 (Refinement) with checkboxes"
    source: "docs/03-decisions/adr-0001-agent-expert-system.md"
