{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agileflow.dev/schemas/status.json",
  "title": "AgileFlow Status",
  "description": "Single source of truth for story statuses, assignments, and dependencies",
  "type": "object",
  "required": ["updated", "stories"],
  "properties": {
    "updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last update"
    },
    "stories": {
      "type": "object",
      "description": "Map of story IDs to story metadata",
      "patternProperties": {
        "^(US|EP)-[0-9]{4}$": {
          "type": "object",
          "required": ["owner", "status", "last_update"],
          "properties": {
            "owner": {
              "type": "string",
              "description": "Agent ID or person responsible",
              "enum": ["MENTOR", "AG-UI", "AG-API", "AG-CI", "AG-DEVOPS", "EPIC-PLANNER", "ADR-WRITER", "RESEARCH"],
              "pattern": "^(MENTOR|AG-UI|AG-API|AG-CI|AG-DEVOPS|EPIC-PLANNER|ADR-WRITER|RESEARCH|[A-Za-z0-9_-]+)$"
            },
            "status": {
              "type": "string",
              "description": "Current story status",
              "enum": ["ready", "in-progress", "blocked", "in-review", "done"]
            },
            "branch": {
              "type": "string",
              "description": "Git branch name for this story"
            },
            "summary": {
              "type": "string",
              "description": "Brief description of current state or recent work",
              "maxLength": 500
            },
            "last_update": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp of last status change"
            },
            "pr": {
              "type": "string",
              "format": "uri",
              "description": "Pull request URL when in review or done"
            },
            "estimate": {
              "type": "string",
              "description": "Effort estimate",
              "enum": ["0.5d", "1d", "2d", "3d", "5d"]
            },
            "deps": {
              "type": "array",
              "description": "Story IDs this story depends on",
              "items": {
                "type": "string",
                "pattern": "^(US|EP)-[0-9]{4}$"
              },
              "uniqueItems": true
            },
            "blocked_by": {
              "type": "string",
              "description": "Reason for blocked status",
              "maxLength": 500
            },
            "epic": {
              "type": "string",
              "description": "Parent epic ID",
              "pattern": "^EP-[0-9]{4}$"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
